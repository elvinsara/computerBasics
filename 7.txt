using System;
using System.IO;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;

namespace ConsoleLoggingExample
{
    class Program
    {
        static void Main(string[] args)
        {
            // Setup the logging service
            var serviceProvider = new ServiceCollection()
                .AddLogging(configure => configure
                    .AddFile("Logs/log.txt", append: true)) // Log to a file
                .BuildServiceProvider();

            var logger = serviceProvider.GetRequiredService<ILogger<Program>>();

            try
            {
                // Log messages
                logger.LogInformation("Application started");
                PerformOperation(logger);
                logger.LogInformation("Application ended");
            }
            catch (Exception ex)
            {
                logger.LogError(ex, "An error occurred while running the application");
            }
        }

        static void PerformOperation(ILogger logger)
        {
            logger.LogInformation("Performing operation...");
            // Simulate some work
            System.Threading.Thread.Sleep(1000); // Delay to mimic operation
            logger.LogInformation("Operation completed successfully.");
        }
    }
}
