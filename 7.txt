using System;
using System.IO;
using Outlook = Microsoft.Office.Interop.Outlook;

namespace OutlookEmailAutomation
{
    class Program
    {
        static void Main(string[] args)
        {
            // Sample input
            string recipient = "recipient@example.com";
            string subject = "Monthly Report";
            string body = "Please find the attached report.";
            string attachmentPath = @"C:\path\to\report.pdf"; // Change to your attachment path

            // Send the email
            bool result = SendEmail(recipient, subject, body, attachmentPath);

            // Output the result
            if (result)
            {
                Console.WriteLine($"Email sent successfully to {recipient}");
            }
            else
            {
                Console.WriteLine($"Failed to send email to {recipient}");
            }
        }

        static bool SendEmail(string recipient, string subject, string body, string attachmentPath)
        {
            try
            {
                // Validate email address
                if (!IsValidEmail(recipient))
                {
                    Console.WriteLine("Invalid email address.");
                    return false;
                }

                // Create a new Outlook application
                Outlook.Application outlookApp = new Outlook.Application();
                Outlook.MailItem mailItem = (Outlook.MailItem)outlookApp.CreateItem(Outlook.OlItemType.olMailItem);

                // Set email properties
                mailItem.To = recipient;
                mailItem.Subject = subject;
                mailItem.Body = body;

                // Add attachment if it exists
                if (File.Exists(attachmentPath))
                {
                    mailItem.Attachments.Add(attachmentPath);
                }
                else
                {
                    Console.WriteLine("Attachment not found.");
                    return false;
                }

                // Send the email
                mailItem.Send();
                return true;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"An error occurred: {ex.Message}");
                return false;
            }
        }

        static bool IsValidEmail(string email)
        {
            try
            {
                var emailAddress = new System.Net.Mail.MailAddress(email);
                return emailAddress.Address == email;
            }
            catch
            {
                return false;
            }
        }
    }
}
